var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,s=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&o(e,n,t[n]);if(r)for(var n of r(t))i.call(t,n)&&o(e,n,t[n]);return e};import{r as l,a as d,R as c}from"./react-vendor-3e9c946d.js";import{c as m}from"./state-15ddd646.js";import{T as u,C as g,a as p,D as h,F as f,b as y,A as x}from"./ui-vendor-fd39ecb8.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var b={exports:{}},E={},v=l,C=Symbol.for("react.element"),F=Symbol.for("react.fragment"),N=Object.prototype.hasOwnProperty,R=v.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,T={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,n){var r,a={},i=null,o=null;for(r in void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(o=t.ref),t)N.call(t,r)&&!T.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:C,type:e,key:i,ref:o,props:a,_owner:R.current}}E.Fragment=F,E.jsx=w,E.jsxs=w,b.exports=E;var M=b.exports,S={},A=d;S.createRoot=A.createRoot,S.hydrateRoot=A.hydrateRoot;const I={},O=function(e,t,n){if(!t||0===t.length)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/"+e}(e))in I)return;I[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(!!n)for(let n=r.length-1;n>=0;n--){const a=r[n];if(a.href===e&&(!t||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${e}"]${a}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),t?new Promise((t,n)=>{i.addEventListener("load",t),i.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})},_={herdSize:150,season:"Summer",systemType:"intensive",feedQuality:7,concentrateFeed:8.08,feedCost:.35,feedCarbonFootprint:.75,soyaContent:0,deforestationFree:!1,nitrogenRate:180,crudeProtein:17,milkYield:8500,avgLactations:3.9,calvingInterval:380,ageFirstCalving:24.7,cullingAge:6.12,birthweight:40,grazingMonths:7,manureSystem:"Liquid/slurry",landType:"Lowland",forageContent:"Mixed 15-75%",treePlantingHa:0,hedgerowKm:0,soilCarbonHa:0,coverCropsHa:0,renewableEnergyKw:0,methaneInhibitor:!1,improvedManure:!1},P=m(e=>({parameters:_,loanAmount:5e5,loanTerm:10,updateParameter:(r,a)=>e(e=>{return{parameters:(i=s({},e.parameters),o={[r]:a},t(i,n(o)))};var i,o}),updateMultipleParameters:t=>e(e=>({parameters:s(s({},e.parameters),t)})),updateLoanParameter:(t,n)=>e(e=>({[t]:n})),resetParameters:()=>e({parameters:_,loanAmount:5e5,loanTerm:10})})),j={BASE_ENTERIC:2400,FEED_MULTIPLIER:35,MANURE_SYSTEMS:{"Liquid/slurry":500,Solid:300,"Daily spread":150,"Anaerobic digester":75,Pasture:200},GRAZING_REDUCTION:30,DEFORESTATION_FACTOR:3.5,NITROGEN_MULTIPLIER:4,FEED_QUALITY_BASE:1.1,FEED_QUALITY_FACTOR:.02,METHANE_BASE:.35,METHANE_DMI_FACTOR:.023,NON_PRODUCTIVE_FACTOR:.3},L={Spring:{feed:1.1,nitrogen:1.2},Summer:{feed:1,nitrogen:1},Autumn:{feed:1.2,nitrogen:.8},Winter:{feed:1.3,nitrogen:.6}},k={intensive:.9,moderate:1,extensive:1.1},$=3.67,D=.6,G=1.5,z=.8,Y=.4,q=.15,H=.3,U=.32,V=.25,B=50,Q={EMISSIONS_TARGET:1.2,COST_TARGET:.35,PROTEIN_EFFICIENCY_TARGET:12,NITROGEN_EFFICIENCY_TARGET:15,CALVING_INTERVAL_TARGET:385,AGE_FIRST_CALVING_TARGET:24,FEED_CARBON_FOOTPRINT_LIMIT:1,SOYA_CONTENT_WARNING:10,OVERALL_HERD_EFFECTIVENESS_TARGET:70,LME_TARGET:10,FEED_EFFICIENCY_TARGET:2.3,RETENTION_RATE_TARGET:75},W=12,K=10,Z=8,J=6,X=305,ee=.9,te=8,ne=.4,re=30.5,ae=(e,t,n=0)=>0===t||isNaN(t)||isNaN(e)?n:e/t,ie=(e,t,n=1)=>((e,t)=>Math.round(e*Math.pow(10,t))/Math.pow(10,t))(100*ae(e,t,0),n),oe=(e,t=0)=>e>0?e:t,se=e=>L[e]||L.Summer,le=e=>{let t=0;e.milkYield<8e3&&(t+=(8e3-e.milkYield)/8e3*.1);const n=ae(365*e.concentrateFeed,e.milkYield,1);return n>.35&&(t+=Math.min(.3*(n-.35),.15)),e.feedCarbonFootprint>1&&(t+=Math.min(.15*(e.feedCarbonFootprint-1),.1)),e.nitrogenRate>150&&(t+=Math.min((e.nitrogenRate-150)/300*.1,.1)),!e.deforestationFree&&e.soyaContent>10&&(t+=Math.min(e.soyaContent/100*.2,.1)),e.grazingMonths<6&&(t+=(6-e.grazingMonths)/12*.08),1+Math.min(t,.4)},de=e=>{const t=se(e.season),n=e.concentrateFeed*t.feed,r=e.nitrogenRate*t.nitrogen,a=ae(1,e.avgLactations,.33),i=e.ageFirstCalving,o=(1+.3*(a*ae(i,12,2)))*(1+(e.calvingInterval>365?.15*ae(e.calvingInterval-365,365,0):0))*le(e),s=(j.BASE_ENTERIC+n*j.FEED_MULTIPLIER)*o,l=((j.MANURE_SYSTEMS[e.manureSystem]||j.MANURE_SYSTEMS["Liquid/slurry"])-e.grazingMonths*j.GRAZING_REDUCTION)*o,d=365*n*e.feedCarbonFootprint*o,c=365*n*ae(e.soyaContent,100),m=e.deforestationFree?0:c*j.DEFORESTATION_FACTOR*o,u=r*j.NITROGEN_MULTIPLIER*o,g=s+oe(l)+d+m+u;return{entericEmissions:oe(s),manureEmissions:oe(l),feedEmissions:oe(d),deforestationEmissions:oe(m),nitrogenEmissions:oe(u),totalAnnualEmissions:oe(g)}},ce=e=>{const t=e.treePlantingHa*$,n=e.hedgerowKm*D,r=e.soilCarbonHa*G,a=e.coverCropsHa*z,i=e.renewableEnergyKw*Y,o=de(e),s=e.methaneInhibitor?ae(o.entericEmissions*q*e.herdSize,1e3):0,l=e.improvedManure?ae(o.manureEmissions*H*e.herdSize,1e3):0,d=t+n+r+a+i+s+l;return{treeSequestration:oe(t),hedgerowSequestration:oe(n),soilCarbonSequestration:oe(r),coverCropSequestration:oe(a),renewableOffset:oe(i),methaneReduction:oe(s),improvedManureReduction:oe(l),totalSequestration:oe(d)}},me=(e,t)=>ae(e*t,1e3,0),ue=e=>{const{annualMilkYield:t,averageLactations:n,ageAtFirstCalving:r,calvingInterval:a,feedQuality:i,systemType:o,concentrateFeed:s,manureSystem:l,grazingMonths:d,feedCarbonFootprint:c,soyaContent:m,deforestationFree:u,nitrogenRate:g,season:p}=e,h=t*n*ee,f=ae(t,X),y=(j.METHANE_BASE+(f*ne+te)*j.METHANE_DMI_FACTOR)*(j.FEED_QUALITY_BASE-i*j.FEED_QUALITY_FACTOR),x=n*X,b=r*re+n*a,E=Math.max(0,b-x),v=y*x+y*j.NON_PRODUCTIVE_FACTOR*E,C=ae(h,v,0)*(k[o]||k.moderate),F=de({annualMilkYield:t,concentrateFeed:s,manureSystem:l,grazingMonths:d,feedCarbonFootprint:c,soyaContent:m,deforestationFree:u,nitrogenRate:g,season:p,herdSize:150,systemType:o,feedQuality:i,feedCost:.35,crudeProtein:17,milkYield:t,avgLactations:n,calvingInterval:a,ageFirstCalving:r,cullingAge:6,birthweight:40,landType:"Lowland",forageContent:"Mixed 15-75%",treePlantingHa:0,hedgerowKm:0,soilCarbonHa:0,coverCropsHa:0,renewableEnergyKw:0,methaneInhibitor:!1,improvedManure:!1}),N=ae(F.totalAnnualEmissions,t);return{lme:oe(C),lifetimeProduction:Math.round(oe(h)),lifetimeEmissions:Math.round(oe(v)),interpretation:(R=C,R>W?{text:"Excellent efficiency",color:"text-green-600",bgColor:"bg-green-50"}:R>K?{text:"Good efficiency",color:"text-blue-600",bgColor:"bg-blue-50"}:R>Z?{text:"Average efficiency",color:"text-yellow-600",bgColor:"bg-yellow-50"}:R>J?{text:"Below average",color:"text-orange-600",bgColor:"bg-orange-50"}:{text:"Poor efficiency",color:"text-red-600",bgColor:"bg-red-50"}),originalEmissions:N};var R},ge=(e,t,n=1)=>e*n*t*365,pe=(e,t=1)=>e*t*j.NITROGEN_MULTIPLIER,he=e=>V*e,fe=(e,t)=>{const n=ae(100,e);return ae(B*t*n,100)},ye=(e,t,n)=>{const r=ae(e*t*n,1e4);return a=r,i=0,o=100,Math.max(i,Math.min(o,a));var a,i,o},xe=(e,t,n,r,a)=>{const i=((e,t,n=1)=>ae(e,t*n*365,0))(e.milkYield,e.concentrateFeed,r),o=((e,t,n=1)=>14.3-.1*(e*n-8.08)+.05*(17-t))(e.concentrateFeed,e.crudeProtein,r),s=((e,t,n,r=1)=>17.6-.02*(e*r-180)+.1*ae(t,12)+.001*(n-8500))(e.nitrogenRate,e.grazingMonths,e.milkYield,a),l=(d=e.avgLactations,ae(100,d,100));var d;const c=(e=>100-e)(l),m=(e=>{if(e<=25)return 100;const t=100-10*(e-25);return Math.max(0,t)})(e.ageFirstCalving),u=(e=>{const t=Q.CALVING_INTERVAL_TARGET;if(e<=t)return 100;const n=100-.5*(e-t);return Math.max(0,n)})(e.calvingInterval);return{emissions:t,feedEfficiency:i,proteinEfficiency:o,nitrogenEfficiency:s,costPerLitre:n,overallHerdEffectiveness:ye(m,u,c),calvingUnder25Pct:m,hitCalvingIntervalPct:u,retentionRate:c,replacementRate:l}},be=()=>{const e=P(e=>e.parameters),t=l.useMemo(()=>se(e.season),[e.season]),n=l.useMemo(()=>de(e),[e]),r=l.useMemo(()=>{return t=n.totalAnnualEmissions,r=e.milkYield,ae(t,r,0);var t,r},[n.totalAnnualEmissions,e.milkYield]),a=l.useMemo(()=>ce(e),[e]),i=l.useMemo(()=>me(n.totalAnnualEmissions,e.herdSize),[n.totalAnnualEmissions,e.herdSize]),o=l.useMemo(()=>((e,t)=>e-t)(i,a.totalSequestration),[i,a.totalSequestration]),s=l.useMemo(()=>e.milkYield*e.herdSize/1e3,[e.milkYield,e.herdSize]),d=l.useMemo(()=>{return n={concentrateFeed:e.concentrateFeed,feedCost:e.feedCost,nitrogenRate:e.nitrogenRate,milkYield:e.milkYield,avgLactations:e.avgLactations,ageFirstCalving:e.ageFirstCalving,seasonalFeedFactor:t.feed,seasonalNitrogenFactor:t.nitrogen},ge(n.concentrateFeed,n.feedCost,n.seasonalFeedFactor)+pe(n.nitrogenRate,n.seasonalNitrogenFactor)+he(n.milkYield)+fe(n.avgLactations,n.ageFirstCalving);var n},[e,t]),c=l.useMemo(()=>((e,t)=>ae(e,t))(d,e.milkYield),[d,e.milkYield]),m=l.useMemo(()=>(e=>{const t=ge(e.concentrateFeed,e.feedCost,e.seasonalFeedFactor),n=pe(e.nitrogenRate,e.seasonalNitrogenFactor),r=he(e.milkYield),a=fe(e.avgLactations,e.ageFirstCalving),i=t+n+r+a;return 0===i?[{name:"Feed Costs",value:40,amount:0},{name:"Nitrogen Costs",value:10,amount:0},{name:"Operational Costs",value:35,amount:0},{name:"Heifer Costs",value:15,amount:0}]:[{name:"Feed Costs",value:ie(t,i),amount:t},{name:"Nitrogen Costs",value:ie(n,i),amount:n},{name:"Operational Costs",value:ie(r,i),amount:r},{name:"Heifer Costs",value:ie(a,i),amount:a}]})({concentrateFeed:e.concentrateFeed,feedCost:e.feedCost,nitrogenRate:e.nitrogenRate,milkYield:e.milkYield,avgLactations:e.avgLactations,ageFirstCalving:e.ageFirstCalving,seasonalFeedFactor:t.feed,seasonalNitrogenFactor:t.nitrogen}),[e,t]),u=l.useMemo(()=>d*e.herdSize,[d,e.herdSize]),g=l.useMemo(()=>((e,t,n=U)=>e*t*n)(e.milkYield,e.herdSize),[e.milkYield,e.herdSize]),p=l.useMemo(()=>g-u,[g,u]),h=l.useMemo(()=>ue({annualMilkYield:e.milkYield,averageLactations:e.avgLactations,ageAtFirstCalving:e.ageFirstCalving,calvingInterval:e.calvingInterval,feedQuality:e.feedQuality,systemType:e.systemType,concentrateFeed:e.concentrateFeed,manureSystem:e.manureSystem,grazingMonths:e.grazingMonths,feedCarbonFootprint:e.feedCarbonFootprint,soyaContent:e.soyaContent,deforestationFree:e.deforestationFree,nitrogenRate:e.nitrogenRate,season:e.season}),[e]),f=l.useMemo(()=>xe(e,r,c,t.feed,t.nitrogen),[e,r,c,t]);return{parameters:e,seasonalFactors:t,emissions:n,emissionsIntensity:r,totalFarmEmissions:i,sequestration:a,netFarmEmissions:o,totalFarmProduction:s,totalAnnualCost:d,costPerLitre:c,costBreakdown:m,totalFarmCost:u,totalFarmRevenue:g,totalFarmProfit:p,lmeResult:h,performanceMetrics:f}},Ee=(e,t)=>{let n;n=e<.9?"Low":e<1.2?"Medium":"High",e>1.8&&(n="High");const r=t>=4e6?2:t>=15e5?1:0,a=["Low","Medium","High"],i=a.indexOf(n);return a[Math.min(2,i+r)]},ve=(e,t)=>{let n;return n=t<1e6?"small":t<=5e6?"medium":"large",{Low:{small:.045,medium:.04,large:.035},Medium:{small:.05,medium:.045,large:.04},High:{small:.055,medium:.05,large:.045}}[e][n]},Ce=(e,t,n)=>{const r=t/12,a=12*n;return 0===r?e/a:e*r/(1-Math.pow(1+r,-a))},Fe=(e,t)=>e*t*12,Ne=({score:e})=>M.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${(e=>{switch(e){case"Low":return"bg-green-100 text-green-800 border-green-200";case"Medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"High":return"bg-red-100 text-red-800 border-red-200"}})(e)}`,children:[e," Risk"]}),Re=()=>{const{totalFarmEmissions:e,sequestration:t,netFarmEmissions:n,totalFarmProduction:r,totalFarmCost:a,totalFarmProfit:i,emissionsIntensity:o}=be(),{loanAmount:s}=P(),d=l.useMemo(()=>Ee(o,s),[o,s]);return M.jsxs("div",{className:"mt-8 pt-6 border-t",children:[M.jsxs("div",{className:"flex items-center justify-between mb-4",children:[M.jsxs("h3",{className:"text-sm font-semibold flex items-center",children:[M.jsx(u,{className:"mr-2",size:16}),"Farm Summary"]}),M.jsx(Ne,{score:d})]}),M.jsxs("div",{className:"space-y-3",children:[M.jsxs("div",{children:[M.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Gross Emissions"}),M.jsxs("div",{className:"text-lg font-bold text-red-600",children:[e.toFixed(0)," t CO₂e/year"]})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Sequestration"}),M.jsxs("div",{className:"text-lg font-bold text-green-600",children:[t.totalSequestration.toFixed(0)," t CO₂e/year"]})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Net Emissions"}),M.jsxs("div",{className:"text-lg font-bold "+(n>0?"text-orange-600":"text-green-600"),children:[n.toFixed(0)," t CO₂e/year"]})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Total Production"}),M.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[r.toFixed(0),"k L/year"]})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Total Cost"}),M.jsxs("div",{className:"text-lg font-bold text-orange-600",children:["£",(a/1e3).toFixed(0),"k"]})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Est. Annual Profit"}),M.jsxs("div",{className:"text-lg font-bold "+(i>0?"text-green-600":"text-red-600"),children:["£",(i/1e3).toFixed(0),"k"]})]})]})]})},Te=({tabs:e,active:t,onSelect:n})=>{const r=l.useRef(null),[a,i]=l.useState(e),[o,s]=l.useState([]),[d,c]=l.useState(!1);return l.useEffect(()=>{const t=()=>{const t=r.current;if(!t)return;const n=t.clientWidth-60;let a=0;const o=[],l=[];e.forEach(e=>{const t=24+8*e.label.length+(e.alert?16:0)+(e.emoji?20:0);a+t<=n?(o.push(e),a+=t):l.push(e)}),i(o),s(l)};t();const n=new ResizeObserver(t);return r.current&&n.observe(r.current),()=>n.disconnect()},[e]),l.useEffect(()=>{if(!d)return;const e=()=>c(!1);return window.addEventListener("click",e),()=>window.removeEventListener("click",e)},[d]),l.useEffect(()=>{if(!d)return;const e=e=>{"Escape"===e.key&&c(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[d]),M.jsxs("div",{ref:r,className:"relative flex space-x-1 mb-4 border-b",children:[a.map(e=>M.jsxs("button",{onClick:()=>n(e.id),className:`\n            flex-shrink-0 px-3 py-2 text-sm font-medium border-b-2 transition-colors\n            ${t===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}\n          `,children:[e.label,e.emoji&&M.jsx("span",{className:"text-xs ml-1",children:e.emoji}),e.alert&&M.jsx("span",{className:"ml-1 text-red-500",children:"●"})]},e.id)),o.length>0&&M.jsxs("div",{className:"relative",children:[M.jsxs("button",{onClick:e=>{e.stopPropagation(),c(!d)},className:`\n              flex items-center px-2 py-2 text-sm font-medium\n              border-b-2 transition-colors focus:outline-none\n              ${o.some(e=>e.id===t)?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}\n            `,"aria-expanded":d,"aria-haspopup":"true",children:["More ",M.jsx(g,{size:14,className:"ml-1"})]}),d&&M.jsx("ul",{className:"absolute right-0 z-10 mt-1 w-48 bg-white shadow-lg\n                         rounded-md border text-sm",onClick:e=>e.stopPropagation(),role:"menu",children:o.map(e=>M.jsx("li",{role:"none",children:M.jsxs("button",{onClick:()=>{n(e.id),c(!1)},className:`\n                      w-full text-left px-3 py-2 hover:bg-gray-100 flex items-center justify-between\n                      ${t===e.id?"font-semibold text-blue-600 bg-blue-50":""}\n                    `,role:"menuitem",children:[M.jsxs("span",{children:[e.label,e.emoji&&M.jsx("span",{className:"text-xs ml-1",children:e.emoji})]}),e.alert&&M.jsx("span",{className:"text-red-500",children:"●"})]})},e.id))})]})]})},we=l.createContext(void 0),Me=({children:e})=>{const[t,n]=l.useState("basic");return M.jsx(we.Provider,{value:{activeTab:t,setActiveTab:n},children:e})},Se=()=>{const e=l.useContext(we);if(!e)throw new Error("useView must be used within a ViewProvider");return e},Ae=()=>{const{activeTab:e,setActiveTab:t}=Se(),n=be(),r=e=>{switch(e){case"basic":return n.parameters.feedCarbonFootprint>Q.FEED_CARBON_FOOTPRINT_LIMIT||n.parameters.soyaContent>Q.SOYA_CONTENT_WARNING&&!n.parameters.deforestationFree;case"farm":return n.parameters.calvingInterval>Q.CALVING_INTERVAL_TARGET||n.parameters.milkYield<8e3;case"heifer":return n.parameters.ageFirstCalving>Q.AGE_FIRST_CALVING_TARGET||n.parameters.grazingMonths<6;case"sequestration":return n.sequestration.totalSequestration<.1*n.totalFarmEmissions;case"effectiveness":return n.performanceMetrics.overallHerdEffectiveness<Q.OVERALL_HERD_EFFECTIVENESS_TARGET;default:return!1}},a=[{id:"basic",label:"Basic",alert:r("basic")},{id:"farm",label:"Farm",alert:r("farm")},{id:"heifer",label:"Heifer",alert:r("heifer")},{id:"sequestration",label:"Sequestration",emoji:"💰",alert:r("sequestration")},{id:"effectiveness",label:"Effectiveness",alert:r("effectiveness")},{id:"scenarios",label:"Scenarios",emoji:"🚀"},{id:"financing",label:"Financing",emoji:"💳"}];return M.jsxs("div",{className:"w-80 bg-white shadow-lg p-6 overflow-y-auto",children:[M.jsxs("div",{className:"mb-6",children:[M.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[M.jsx(p,{className:"mr-2",size:20}),"Parameters"]}),M.jsx(Te,{tabs:a,active:e,onSelect:e=>t(e)})]}),M.jsx(Re,{})]})},Ie={MILK_N_CONTENT:.0055,HECTARES_PER_COW:.5,FEED_N_CONTENT:{BASE:.016,MULTIPLIER:.0016},MANURE_N_EFFICIENCY:{"Liquid/slurry":.45,Solid:.35,"Daily spread":.3,"Anaerobic digester":.55,Pasture:.25},NUE_THRESHOLDS:{POOR:60,AVERAGE:80,GOOD:100}},Oe=e=>{const t=e.nitrogenRate*Ie.HECTARES_PER_COW,n=(r=e.crudeProtein,ae(r,625,.025));var r;return t+365*e.concentrateFeed*n},_e=e=>e.milkYield*Ie.MILK_N_CONTENT,Pe=e=>{const t=_e(e),n=Oe(e),r=100*ae(t,n,0);return Math.min(r,150)},je=e=>e>=Ie.NUE_THRESHOLDS.GOOD?{category:"Excellent",color:"text-green-700",bgColor:"bg-green-50",description:"Outstanding nitrogen efficiency"}:e>=Ie.NUE_THRESHOLDS.AVERAGE?{category:"Good",color:"text-blue-700",bgColor:"bg-blue-50",description:"Above average nitrogen efficiency"}:e>=Ie.NUE_THRESHOLDS.POOR?{category:"Average",color:"text-yellow-700",bgColor:"bg-yellow-50",description:"Room for improvement in N management"}:{category:"Poor",color:"text-red-700",bgColor:"bg-red-50",description:"Significant N losses to environment"},Le=(e,t)=>{const n=[];return e.nitrogenRate>200&&n.push("Reduce N fertilizer application rate to <200 kg N/ha"),e.crudeProtein>18&&n.push("Optimize dietary protein to 16-18% CP"),"Anaerobic digester"!==e.manureSystem&&t<80&&n.push("Consider anaerobic digestion for better N recovery"),e.milkYield<8e3&&t<80&&n.push("Improve milk productivity to dilute N losses"),e.feedQuality<8&&n.push("Improve feed quality for better N utilization"),n},ke={BASE_KG_CO2E_PER_COW:2e3,REFERENCES:{UK_AVERAGE:2200,NZ_AVERAGE:1700,EU_AVERAGE:2100,GLOBAL_AVERAGE:2500},CITATION:"Awaiting peer review. Based on preliminary analysis of biological minimums in optimized dairy systems."},$e=ke.BASE_KG_CO2E_PER_COW,De={EXCELLENT:10,GOOD:25,AVERAGE:50},Ge=e=>e*$e,ze=(e,t)=>{const n=Ge(t);return 0===n?0:(e-n)/n*100},Ye=e=>e<=De.EXCELLENT?{category:"Excellent",color:"text-green-700",description:"Near biological minimum - outstanding efficiency"}:e<=De.GOOD?{category:"Good",color:"text-blue-700",description:"Well-optimized operations"}:e<=De.AVERAGE?{category:"Average",color:"text-yellow-700",description:"Significant reduction opportunities exist"}:{category:"Poor",color:"text-red-700",description:"Major improvements needed"},qe=.015,He=.15,Ue=.1,Ve=.08,Be=.12,Qe=.05,We=.03,Ke=.07,Ze=50,Je=200,Xe=150,et=100,tt=80,nt=60,rt=120,at=40,it=(e,t=2035)=>{const n=t-(new Date).getFullYear(),r=de(e),a=1e3*me(r.totalAnnualEmissions,e.herdSize),i=Ge(e.herdSize),o=a-i,s=[];let l=0,d=0;if(e.feedQuality<9){const t=9-e.feedQuality,n=a*qe*t,r=Ze*t*e.herdSize;s.push({id:"feed-quality",name:"Improve Feed Quality",description:`Upgrade feed quality from ${e.feedQuality}/10 to 9/10`,potentialReduction:n,cost:r,difficulty:"Easy",timeToImplement:3,category:"Feed"}),l+=n,d+=r}if(!e.methaneInhibitor){const t=a*He,n=Je*e.herdSize;s.push({id:"methane-inhibitor",name:"Adopt Methane Inhibitors",description:"Add 3-NOP or similar feed additives to reduce enteric methane",potentialReduction:t,cost:n,difficulty:"Easy",timeToImplement:1,category:"Technology"}),l+=t,d+=n}if("Anaerobic digester"!==e.manureSystem){const t=a*Ue,n=Xe*e.herdSize;s.push({id:"manure-digester",name:"Install Anaerobic Digester",description:"Upgrade manure management to anaerobic digestion with biogas capture",potentialReduction:t,cost:n,difficulty:"Hard",timeToImplement:12,category:"Manure"}),l+=t,d+=n}if(l<o){const t=a*Ve,n=et*e.herdSize;s.push({id:"precision-feeding",name:"Implement Precision Feeding",description:"Individual cow feeding optimization with smart feeders",potentialReduction:t,cost:n,difficulty:"Medium",timeToImplement:6,category:"Technology"}),l+=t,d+=n}if(l<o){const t=a*Be,n=tt*e.herdSize;s.push({id:"improved-genetics",name:"Accelerate Genetic Progress",description:"Select for low-methane genetics and improved feed efficiency",potentialReduction:t,cost:n,difficulty:"Medium",timeToImplement:24,category:"Management"}),l+=t,d+=n}if(l<o){const t=a*Qe,n=nt*e.herdSize;s.push({id:"heat-abatement",name:"Install Heat Abatement",description:"Cooling systems to reduce heat stress and improve efficiency",potentialReduction:t,cost:n,difficulty:"Medium",timeToImplement:3,category:"Technology"}),l+=t,d+=n}if(l<o){const t=a*We,n=rt*e.herdSize;s.push({id:"renewable-energy",name:"Switch to Renewable Energy",description:"Solar panels and renewable energy for farm operations",potentialReduction:t,cost:n,difficulty:"Hard",timeToImplement:6,category:"Technology"}),l+=t,d+=n}if(e.ageFirstCalving>22||e.calvingInterval>380){const t=a*Ke,n=at*e.herdSize;s.push({id:"optimized-reproduction",name:"Optimize Reproduction",description:"Improve fertility management to reduce heifer overhead",potentialReduction:t,cost:n,difficulty:"Easy",timeToImplement:12,category:"Management"}),l+=t,d+=n}return s.sort((e,t)=>{const n=e.potentialReduction/e.cost;return t.potentialReduction/t.cost-n}),{currentEmissions:a,targetEmissions:i,gap:o,measures:s,totalPotentialReduction:l,totalCost:d,timeToTarget:n,canReachTarget:l>=.9*o}},ot=e=>{const t=(new Date).getFullYear(),n=[];let r=0;const a=e.measures.reduce((e,n)=>{const r=t+Math.ceil(n.timeToImplement/12);return e[r]||(e[r]=[]),e[r].push(n),e},{});return Object.keys(a).sort((e,t)=>Number(e)-Number(t)).forEach(t=>{a[Number(t)].forEach(a=>{r+=a.potentialReduction,n.push({year:Number(t),measure:a.name,cumulativeReduction:r,remainingGap:Math.max(0,e.gap-r)})})}),n},st=(e,t=.04)=>{const n=e.totalCost,r=.02*e.totalPotentialReduction,a=t/12,i=n*(a*Math.pow(1+a,120))/(Math.pow(1+a,120)-1)*12,o=n/r;let s=-n;for(let l=1;l<=10;l++)s+=r/Math.pow(1+t,l);return{totalInvestment:n,annualPayment:i,paybackPeriod:o,netPresentValue:s}},lt=[{id:"green-loan",name:"Green Agriculture Loan",description:"Low-interest loan for environmental improvements",type:"loan",maxAmount:1e6,interestRate:.035,term:10,requirements:["Environmental impact assessment","Emissions reduction plan"],greenDiscount:.015},{id:"equipment-finance",name:"Sustainable Equipment Finance",description:"Asset finance for green technology",type:"loan",maxAmount:5e5,interestRate:.045,term:7,requirements:["Equipment must reduce emissions by >10%"],greenDiscount:.01},{id:"govt-grant",name:"Government Sustainability Grant",description:"Non-repayable grant for proven technologies",type:"grant",maxAmount:1e5,interestRate:0,term:0,requirements:["Must implement methane reduction","Monitoring required"],greenDiscount:0},{id:"carbon-advance",name:"Carbon Credit Advance",description:"Upfront payment against future carbon credits",type:"carbon-credit",maxAmount:2e5,interestRate:.06,term:5,requirements:["Verified baseline emissions","Credit generation plan"],greenDiscount:0},{id:"blended-finance",name:"Blended Finance Package",description:"Combined loan and grant funding",type:"blended",maxAmount:75e4,interestRate:.025,term:8,requirements:["Large-scale project","Multiple environmental benefits"],greenDiscount:.02}],dt=(e,t=700,n=0)=>{const r=e.totalCost,a=[],i=[...e.measures].sort((e,t)=>{const n=e.potentialReduction/e.cost;return t.potentialReduction/t.cost-n});let o=r;for(const m of i){if(o<=0)break;const e=ct(m);if(e){const t=Math.min(m.cost,e.maxAmount,o),n=e.interestRate-e.greenDiscount,r={option:e,amount:t,monthlyCost:mt(t,n,e.term),totalCost:ut(t,n,e.term),carbonBenefit:m.potentialReduction*t/m.cost};a.push(r),o-=t}}const s=a.reduce((e,t)=>e+t.monthlyCost,0),l=a.reduce((e,t)=>e+t.totalCost,0),d=a.reduce((e,t)=>e+t.carbonBenefit,0),c=.025*d;return{totalInvestment:r,financingOptions:a,totalMonthlyCost:s,totalFinancingCost:l,paybackPeriod:l/(12*c),netPresentValue:gt(r,c,10,.05),internalRateOfReturn:pt(r,c,10),carbonCostEffectiveness:l/d}},ct=(e,t)=>"methane-inhibitor"===e.id?lt.find(e=>"govt-grant"===e.id)||null:"Technology"===e.category&&e.cost>5e4?lt.find(e=>"equipment-finance"===e.id)||null:"Easy"===e.difficulty&&e.timeToImplement<=6?lt.find(e=>"carbon-advance"===e.id)||null:e.cost>2e5?lt.find(e=>"blended-finance"===e.id)||null:lt.find(e=>"green-loan"===e.id)||null,mt=(e,t,n)=>{if(0===t||0===n)return 0;const r=t/12,a=12*n;return e*(r*Math.pow(1+r,a))/(Math.pow(1+r,a)-1)},ut=(e,t,n)=>{if(0===t||0===n)return 0;return mt(e,t,n)*n*12},gt=(e,t,n,r)=>{let a=-e;for(let i=1;i<=n;i++)a+=t/Math.pow(1+r,i);return a},pt=(e,t,n)=>{let r=0,a=0;for(let i=0;i<=1;i+=.001){a=-e;for(let e=1;e<=n;e++)a+=t/Math.pow(1+i,e);if(!(a>0))break;r=i}return r},ht=(e,t,n,r)=>{const a=.1*t,i=.3*e-a,o=r>20?.02:r>10?.01:0,s=lt.filter(e=>{if("grant"===e.type)return!0;const t="loan"===e.type?650:700;return n>=t}),l=.04;return{maxLoanAmount:i/12*(Math.pow(1+l/12,96)-1)/(l/12*Math.pow(1+l/12,96)),eligibleOptions:s,debtServiceRatio:a/e,greenBonus:o}},ft=e=>{const t=de(e),n=me(t.totalAnnualEmissions,e.herdSize),r=t.totalAnnualEmissions/e.milkYield,a=ue({annualMilkYield:e.milkYield,averageLactations:e.avgLactations,ageAtFirstCalving:e.ageFirstCalving,calvingInterval:e.calvingInterval,feedQuality:e.feedQuality,systemType:e.systemType,concentrateFeed:e.concentrateFeed,manureSystem:e.manureSystem,grazingMonths:e.grazingMonths,feedCarbonFootprint:e.feedCarbonFootprint,soyaContent:e.soyaContent,deforestationFree:e.deforestationFree,nitrogenRate:e.nitrogenRate,season:e.season}),i=Pe(e),o=a.lme*(i/100),s=Math.min(50,a.lme/15*50)+Math.min(50,i/150*50),l=Ge(e.herdSize),d=1e3*n,c=ze(d,e.herdSize),m=Ye(c),u=ce(e),g=it(e),p=dt(g,720,0);return{timestamp:(new Date).toISOString(),farmName:`Farm_${e.herdSize}_cows`,parameters:e,emissions:{total:n,intensity:r,breakdown:{enteric:t.entericEmissions,manure:t.manureEmissions,feed:t.feedEmissions,nitrogen:t.nitrogenEmissions}},performance:{lme:a.lme,nue:i,lmePlusNue:o,sustainabilityScore:s},theoreticalMinimum:{tm:l/1e3,current:n,percentageAbove:c,category:m.category,gap:(d-l)/1e3},sequestration:{total:u.totalSequestration,breakdown:{trees:u.treeSequestration,hedgerows:u.hedgerowSequestration,soil:u.soilCarbonSequestration,coverCrops:1.5*e.coverCropsHa,renewable:4e-4*e.renewableEnergyKw,methaneInhibitor:u.methaneReduction,improvedManure:u.improvedManureReduction}},reductionPathway:{measures:g.measures.map(t=>({name:t.name,potential:t.potentialReduction,cost:t.cost,roi:.025*t.potentialReduction/(t.cost/e.herdSize)*100})),totalPotential:g.totalPotentialReduction,totalCost:g.totalCost,canReachTM:g.canReachTarget},financing:{totalInvestment:p.totalInvestment,monthlyPayment:p.totalMonthlyCost,paybackPeriod:p.paybackPeriod,npv:p.netPresentValue,irr:p.internalRateOfReturn}}},yt=(e,t,n)=>{const r=new Blob([e],{type:n}),a=URL.createObjectURL(r),i=document.createElement("a");i.href=a,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)},xt=()=>{const[e,t]=l.useState(!1),n=P(e=>e.parameters);return M.jsxs("div",{className:"relative",children:[M.jsxs("button",{onClick:()=>t(!e),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:[M.jsx(h,{className:"w-4 h-4"}),"Export Report"]}),e&&M.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10",children:[M.jsxs("button",{onClick:()=>{const e=(e=>{const t=["GHG WHAT-IF Tool Export - Version 4.0",`Export Date: ${new Date(e.timestamp).toLocaleString()}`,`Farm: ${e.farmName}`,"","=== EMISSIONS SUMMARY ===",`Total Annual Emissions,${e.emissions.total.toFixed(1)},t CO2e`,`Emissions Intensity,${e.emissions.intensity.toFixed(3)},kg CO2e/L`,"","Emissions Breakdown",`Enteric Methane,${e.emissions.breakdown.enteric.toFixed(1)},kg CO2e/cow/year`,`Manure,${e.emissions.breakdown.manure.toFixed(1)},kg CO2e/cow/year`,`Feed,${e.emissions.breakdown.feed.toFixed(1)},kg CO2e/cow/year`,`Nitrogen,${e.emissions.breakdown.nitrogen.toFixed(1)},kg CO2e/cow/year`,"","=== PERFORMANCE METRICS ===",`LME Score,${e.performance.lme.toFixed(0)},L milk/t CO2e`,`NUE,${e.performance.nue.toFixed(1)},%`,`LME+NUE Combined,${e.performance.lmePlusNue.toFixed(1)}`,`Sustainability Score,${e.performance.sustainabilityScore.toFixed(1)}/100`,"","=== THEORETICAL MINIMUM ANALYSIS ===",`Theoretical Minimum,${e.theoreticalMinimum.tm.toFixed(1)},t CO2e`,`Current Emissions,${e.theoreticalMinimum.current.toFixed(1)},t CO2e`,`Above TM,${e.theoreticalMinimum.percentageAbove.toFixed(1)},%`,`Performance Category,${e.theoreticalMinimum.category}`,`Gap to TM,${e.theoreticalMinimum.gap.toFixed(1)},t CO2e`,"","=== SEQUESTRATION ===",`Total Sequestration,${e.sequestration.total.toFixed(1)},t CO2e/year`,`Trees,${e.sequestration.breakdown.trees.toFixed(1)},t CO2e/year`,`Hedgerows,${e.sequestration.breakdown.hedgerows.toFixed(1)},t CO2e/year`,`Soil Carbon,${e.sequestration.breakdown.soil.toFixed(1)},t CO2e/year`,`Cover Crops,${e.sequestration.breakdown.coverCrops.toFixed(1)},t CO2e/year`,`Renewable Energy,${e.sequestration.breakdown.renewable.toFixed(1)},t CO2e/year`,`Methane Inhibitor,${e.sequestration.breakdown.methaneInhibitor.toFixed(1)},t CO2e/year`,`Improved Manure,${e.sequestration.breakdown.improvedManure.toFixed(1)},t CO2e/year`,"","=== REDUCTION PATHWAY ===",`Total Reduction Potential,${(e.reductionPathway.totalPotential/1e3).toFixed(1)},t CO2e/year`,`Total Investment Needed,${e.reductionPathway.totalCost.toFixed(0)},£`,"Can Reach TM,"+(e.reductionPathway.canReachTM?"Yes":"No"),"","Top Reduction Measures","Measure,Potential (kg CO2e),Cost (£),ROI (%)"];return e.reductionPathway.measures.slice(0,5).forEach(e=>{t.push(`${e.name},${e.potential.toFixed(0)},${e.cost.toFixed(0)},${e.roi.toFixed(0)}`)}),t.push("","=== FINANCING SUMMARY ===",`Total Investment,${e.financing.totalInvestment.toFixed(0)},£`,`Monthly Payment,${e.financing.monthlyPayment.toFixed(0)},£`,`Payback Period,${e.financing.paybackPeriod.toFixed(1)},years`,`NPV (10 years),${e.financing.npv.toFixed(0)},£`,`IRR,${(100*e.financing.irr).toFixed(1)},%`,"","=== FARM PARAMETERS ===",`Herd Size,${e.parameters.herdSize},cows`,`Milk Yield,${e.parameters.milkYield},L/cow/year`,`System Type,${e.parameters.systemType}`,`Feed Quality,${e.parameters.feedQuality}/10`,`Concentrate Feed,${e.parameters.concentrateFeed},kg/day`,`Nitrogen Rate,${e.parameters.nitrogenRate},kg N/ha`,`Crude Protein,${e.parameters.crudeProtein},%`,`Average Lactations,${e.parameters.avgLactations}`,`Age First Calving,${e.parameters.ageFirstCalving},months`,`Calving Interval,${e.parameters.calvingInterval},days`,`Manure System,${e.parameters.manureSystem}`,"Methane Inhibitor,"+(e.parameters.methaneInhibitor?"Yes":"No"),"Improved Manure,"+(e.parameters.improvedManure?"Yes":"No")),t.join("\n")})(ft(n)),r=(new Date).toISOString().split("T")[0];yt(e,`ghg-report-${r}.csv`,"text/csv"),t(!1)},className:"w-full flex items-center gap-2 px-4 py-2 hover:bg-gray-50 transition-colors",children:[M.jsx(f,{className:"w-4 h-4 text-gray-600"}),"Export as CSV"]}),M.jsxs("button",{onClick:()=>{const e=(e=>JSON.stringify(e,null,2))(ft(n)),r=(new Date).toISOString().split("T")[0];yt(e,`ghg-report-${r}.json`,"application/json"),t(!1)},className:"w-full flex items-center gap-2 px-4 py-2 hover:bg-gray-50 transition-colors",children:[M.jsx(y,{className:"w-4 h-4 text-gray-600"}),"Export as JSON"]}),M.jsxs("button",{onClick:()=>{const e=ft(n),r=`\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>GHG Report - ${(new Date).toISOString().split("T")[0]}</title>\n        <style>\n          body { font-family: Arial, sans-serif; padding: 20px; }\n          h1 { color: #1f2937; }\n          h2 { color: #374151; margin-top: 30px; }\n          table { width: 100%; border-collapse: collapse; margin: 10px 0; }\n          th, td { padding: 8px; text-align: left; border-bottom: 1px solid #e5e7eb; }\n          th { background-color: #f3f4f6; font-weight: bold; }\n          .metric { display: flex; justify-content: space-between; padding: 5px 0; }\n          .value { font-weight: bold; }\n          .category-${e.theoreticalMinimum.category.toLowerCase()} { \n            color: ${"Excellent"===e.theoreticalMinimum.category?"#10b981":"Good"===e.theoreticalMinimum.category?"#3b82f6":"Average"===e.theoreticalMinimum.category?"#f59e0b":"#ef4444"}; \n          }\n          @media print { \n            body { margin: 0; }\n            h2 { page-break-before: auto; }\n          }\n        </style>\n      </head>\n      <body>\n        <h1>GHG WHAT-IF Tool Report</h1>\n        <p>Generated: ${new Date(e.timestamp).toLocaleString()}</p>\n        <p>Farm: ${e.farmName}</p>\n        \n        <h2>Executive Summary</h2>\n        <div class="metric">\n          <span>Total Annual Emissions:</span>\n          <span class="value">${e.emissions.total.toFixed(1)} t CO₂e</span>\n        </div>\n        <div class="metric">\n          <span>Emissions Intensity:</span>\n          <span class="value">${e.emissions.intensity.toFixed(3)} kg CO₂e/L</span>\n        </div>\n        <div class="metric">\n          <span>Performance vs Theoretical Minimum:</span>\n          <span class="value category-${e.theoreticalMinimum.category.toLowerCase()}">\n            ${e.theoreticalMinimum.percentageAbove.toFixed(1)}% above (${e.theoreticalMinimum.category})\n          </span>\n        </div>\n        \n        <h2>Performance Metrics</h2>\n        <table>\n          <tr>\n            <th>Metric</th>\n            <th>Value</th>\n            <th>Unit</th>\n          </tr>\n          <tr>\n            <td>LME (Lifetime Methane Efficiency)</td>\n            <td>${e.performance.lme.toFixed(0)}</td>\n            <td>L milk/t CO₂e</td>\n          </tr>\n          <tr>\n            <td>NUE (Nitrogen Use Efficiency)</td>\n            <td>${e.performance.nue.toFixed(1)}</td>\n            <td>%</td>\n          </tr>\n          <tr>\n            <td>Combined LME+NUE</td>\n            <td>${e.performance.lmePlusNue.toFixed(1)}</td>\n            <td>-</td>\n          </tr>\n          <tr>\n            <td>Sustainability Score</td>\n            <td>${e.performance.sustainabilityScore.toFixed(1)}</td>\n            <td>/100</td>\n          </tr>\n        </table>\n        \n        <h2>Emissions Breakdown</h2>\n        <table>\n          <tr>\n            <th>Source</th>\n            <th>Emissions</th>\n            <th>Unit</th>\n          </tr>\n          <tr>\n            <td>Enteric Methane</td>\n            <td>${e.emissions.breakdown.enteric.toFixed(1)}</td>\n            <td>kg CO₂e/cow/year</td>\n          </tr>\n          <tr>\n            <td>Manure</td>\n            <td>${e.emissions.breakdown.manure.toFixed(1)}</td>\n            <td>kg CO₂e/cow/year</td>\n          </tr>\n          <tr>\n            <td>Feed</td>\n            <td>${e.emissions.breakdown.feed.toFixed(1)}</td>\n            <td>kg CO₂e/cow/year</td>\n          </tr>\n          <tr>\n            <td>Nitrogen</td>\n            <td>${e.emissions.breakdown.nitrogen.toFixed(1)}</td>\n            <td>kg CO₂e/cow/year</td>\n          </tr>\n        </table>\n        \n        <h2>Reduction Pathway</h2>\n        <p>Total reduction potential: <strong>${(e.reductionPathway.totalPotential/1e3).toFixed(1)} t CO₂e/year</strong></p>\n        <p>Investment needed: <strong>£${e.reductionPathway.totalCost.toLocaleString()}</strong></p>\n        <p>Can reach theoretical minimum: <strong>${e.reductionPathway.canReachTM?"Yes":"No"}</strong></p>\n        \n        <h3>Top Reduction Measures</h3>\n        <table>\n          <tr>\n            <th>Measure</th>\n            <th>Potential</th>\n            <th>Cost</th>\n            <th>ROI</th>\n          </tr>\n          ${e.reductionPathway.measures.slice(0,5).map(e=>`\n            <tr>\n              <td>${e.name}</td>\n              <td>${e.potential.toFixed(0)} kg CO₂e</td>\n              <td>£${e.cost.toLocaleString()}</td>\n              <td>${e.roi.toFixed(0)}%</td>\n            </tr>\n          `).join("")}\n        </table>\n        \n        <h2>Financing Summary</h2>\n        <table>\n          <tr>\n            <td>Total Investment</td>\n            <td>£${e.financing.totalInvestment.toLocaleString()}</td>\n          </tr>\n          <tr>\n            <td>Monthly Payment</td>\n            <td>£${e.financing.monthlyPayment.toFixed(0)}</td>\n          </tr>\n          <tr>\n            <td>Payback Period</td>\n            <td>${e.financing.paybackPeriod.toFixed(1)} years</td>\n          </tr>\n          <tr>\n            <td>NPV (10 years)</td>\n            <td>£${e.financing.npv.toFixed(0)}</td>\n          </tr>\n          <tr>\n            <td>IRR</td>\n            <td>${(100*e.financing.irr).toFixed(1)}%</td>\n          </tr>\n        </table>\n      </body>\n      </html>\n    `,a=window.open("","_blank");a&&(a.document.write(r),a.document.close(),a.focus(),setTimeout(()=>{a.print()},250)),t(!1)},className:"w-full flex items-center gap-2 px-4 py-2 hover:bg-gray-50 transition-colors rounded-b-lg",children:[M.jsx(f,{className:"w-4 h-4 text-gray-600"}),"Print/PDF Report"]})]})]})},bt=()=>{const{parameters:e,emissionsIntensity:t,netFarmEmissions:n,costPerLitre:r,performanceMetrics:a}=be(),i=le(e),o=(100*(i-1)).toFixed(0);return M.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsxs("div",{className:"flex items-center space-x-3",children:[M.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"GHG WHAT-IF Tool"}),M.jsx("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:"Dairy Farm Optimizer"})]}),M.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[i>1.05&&M.jsxs("div",{className:"flex items-center space-x-2 bg-red-100 text-red-800 px-3 py-1 rounded-full",children:[M.jsx(x,{size:16}),M.jsxs("span",{className:"font-medium",children:["+",o,"% emissions penalty"]})]}),M.jsxs("div",{className:"text-center",children:[M.jsxs("div",{className:"font-semibold text-gray-900",children:[e.herdSize," cows"]}),M.jsx("div",{className:"text-xs text-gray-500",children:"Herd Size"})]}),M.jsxs("div",{className:"text-center",children:[M.jsxs("div",{className:"font-semibold "+(t>1.2?"text-red-600":"text-gray-900"),children:[t.toFixed(2)," kg CO₂e/L"]}),M.jsx("div",{className:"text-xs text-gray-500",children:"Emissions"})]}),M.jsxs("div",{className:"text-center",children:[M.jsxs("div",{className:"font-semibold "+(n>0?"text-orange-600":"text-green-600"),children:[n.toFixed(0)," t/yr"]}),M.jsx("div",{className:"text-xs text-gray-500",children:"Net Carbon"})]}),M.jsxs("div",{className:"text-center",children:[M.jsxs("div",{className:"font-semibold "+(r>.35?"text-red-600":"text-gray-900"),children:["£",r.toFixed(3),"/L"]}),M.jsx("div",{className:"text-xs text-gray-500",children:"Cost"})]}),M.jsxs("div",{className:"text-center",children:[M.jsxs("div",{className:"font-semibold "+(a.overallHerdEffectiveness>=70?"text-green-600":a.overallHerdEffectiveness>=50?"text-yellow-600":"text-red-600"),children:[a.overallHerdEffectiveness.toFixed(1),"%"]}),M.jsx("div",{className:"text-xs text-gray-500",children:"Effectiveness"})]}),M.jsx(xt,{})]})]})})},Et=()=>M.jsx("div",{className:"flex items-center justify-center min-h-[500px]",children:M.jsxs("div",{className:"text-center",children:[M.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),M.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}),vt=l.lazy(()=>O(()=>import("./BasicDashboard-e39bed73.js"),["assets/BasicDashboard-e39bed73.js","assets/chart-vendor-6d7d213e.js","assets/react-vendor-3e9c946d.js","assets/ui-vendor-fd39ecb8.js","assets/Slider-03b4b334.js","assets/state-15ddd646.js"])),Ct=l.lazy(()=>O(()=>import("./FarmDashboard-92020a24.js"),["assets/FarmDashboard-92020a24.js","assets/Slider-03b4b334.js","assets/react-vendor-3e9c946d.js","assets/state-15ddd646.js","assets/ui-vendor-fd39ecb8.js"])),Ft=l.lazy(()=>O(()=>import("./HeiferDashboard-36e0ab6a.js"),["assets/HeiferDashboard-36e0ab6a.js","assets/Slider-03b4b334.js","assets/react-vendor-3e9c946d.js","assets/state-15ddd646.js","assets/ui-vendor-fd39ecb8.js"])),Nt=l.lazy(()=>O(()=>import("./SequestrationDashboard-4644e722.js"),["assets/SequestrationDashboard-4644e722.js","assets/Slider-03b4b334.js","assets/react-vendor-3e9c946d.js","assets/ui-vendor-fd39ecb8.js","assets/chart-vendor-6d7d213e.js","assets/state-15ddd646.js"])),Rt=l.lazy(()=>O(()=>import("./EffectivenessDashboard-7be337b5.js"),["assets/EffectivenessDashboard-7be337b5.js","assets/react-vendor-3e9c946d.js","assets/ui-vendor-fd39ecb8.js","assets/state-15ddd646.js"])),Tt=l.lazy(()=>O(()=>import("./ScenarioDashboard-b2e7ac97.js"),["assets/ScenarioDashboard-b2e7ac97.js","assets/react-vendor-3e9c946d.js","assets/ui-vendor-fd39ecb8.js","assets/state-15ddd646.js"])),wt=l.lazy(()=>O(()=>import("./FinancingDashboard-302c683c.js"),["assets/FinancingDashboard-302c683c.js","assets/react-vendor-3e9c946d.js","assets/state-15ddd646.js","assets/ui-vendor-fd39ecb8.js"])),Mt={basic:vt,farm:Ct,heifer:Ft,sequestration:Nt,effectiveness:Rt,scenarios:Tt,financing:wt};function St(){const{activeTab:e}=Se(),t=(()=>{const e=be(),{parameters:t,loanAmount:n,loanTerm:r}=P();return{emissions:e.emissions,emissionsIntensity:e.emissionsIntensity,totalFarmEmissions:e.totalFarmEmissions,netFarmEmissions:e.netFarmEmissions,sequestration:e.sequestration,totalAnnualCost:e.totalAnnualCost,costPerLitre:e.costPerLitre,costBreakdown:e.costBreakdown,totalFarmCost:e.totalFarmCost,totalFarmRevenue:e.totalFarmRevenue,totalFarmProfit:e.totalFarmProfit,lmeResult:e.lmeResult,performanceMetrics:e.performanceMetrics,totalFarmProduction:e.totalFarmProduction,parameters:t,loanAmount:n,loanTerm:r,seasonalFactors:e.seasonalFactors}})(),n=(()=>{const e=P();return{updateParameter:e.updateParameter,updateMultipleParameters:e.updateMultipleParameters,updateLoanParameter:e.updateLoanParameter,resetParameters:e.resetParameters}})(),r=Mt[e]||vt;return M.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[M.jsx(Ae,{}),M.jsxs("div",{className:"flex-1 overflow-auto",children:[M.jsx(bt,{}),M.jsx(l.Suspense,{fallback:M.jsx(Et,{}),children:M.jsx(r,{state:t,actions:n})})]})]})}function At(){return M.jsx(Me,{children:M.jsx(St,{})})}S.createRoot(document.getElementById("root")).render(M.jsx(c.StrictMode,{children:M.jsx(At,{})}));export{j as E,Ie as N,Q as P,Ne as R,P as a,Ee as b,ve as c,Ce as d,Fe as e,it as f,Ye as g,ot as h,st as i,M as j,Pe as k,Oe as l,_e as m,Le as n,je as o,ze as p,ue as q,de as r,ae as s,Ge as t,be as u,me as v,dt as w,ht as x};
