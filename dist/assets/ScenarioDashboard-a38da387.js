import{c as h,d as j,u as M,j as e,r as x,T as F,A as b,B as N,l as E,C}from"./index-39be7b0d.js";import{L as v}from"./leaf-ac27f8f7.js";import{T as u}from"./trending-down-5c2f744e.js";const A=h("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),I=h("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),S=h("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),y=h("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),w=h("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),P=h("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),R=h("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),z=h("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),$=()=>{const i=j(),{parameters:s,updateParameter:n}=i;M();const l=[{id:"extend-grazing",name:"Extend Grazing Period",description:"Add 1 month to grazing season",icon:e.jsx(A,{className:"w-5 h-5"}),apply:()=>n("grazingMonths",Math.min(12,s.grazingMonths+1)),revert:()=>n("grazingMonths",Math.max(0,s.grazingMonths-1)),isApplied:()=>s.grazingMonths>7,impact:"-3% emissions"},{id:"solar-panels",name:"Install Solar Panels",description:"Add 50 kW renewable capacity",icon:e.jsx(z,{className:"w-5 h-5"}),apply:()=>n("renewableEnergyKw",s.renewableEnergyKw+50),revert:()=>n("renewableEnergyKw",Math.max(0,s.renewableEnergyKw-50)),isApplied:()=>s.renewableEnergyKw>0,impact:"-20 t CO₂e/year"},{id:"methane-inhibitor",name:"Methane Inhibitor Feed",description:"Add feed additives to reduce enteric emissions",icon:e.jsx(w,{className:"w-5 h-5"}),apply:()=>n("methaneInhibitor",!0),revert:()=>n("methaneInhibitor",!1),isApplied:()=>s.methaneInhibitor,impact:"-15% enteric"},{id:"improved-manure",name:"Upgrade Manure System",description:"Implement covered storage and treatment",icon:e.jsx(v,{className:"w-5 h-5"}),apply:()=>n("improvedManure",!0),revert:()=>n("improvedManure",!1),isApplied:()=>s.improvedManure,impact:"-30% manure"},{id:"tree-planting",name:"Plant Trees",description:"Add 5 hectares of woodland",icon:e.jsx(v,{className:"w-5 h-5"}),apply:()=>n("treePlantingHa",s.treePlantingHa+5),revert:()=>n("treePlantingHa",Math.max(0,s.treePlantingHa-5)),isApplied:()=>s.treePlantingHa>0,impact:"+60 t CO₂e/year seq"},{id:"reduce-nitrogen",name:"Optimize Nitrogen Use",description:"Reduce application by 20 kg/ha",icon:e.jsx(y,{className:"w-5 h-5"}),apply:()=>n("nitrogenRate",Math.max(100,s.nitrogenRate-20)),revert:()=>n("nitrogenRate",s.nitrogenRate+20),isApplied:()=>s.nitrogenRate<180,impact:"-5% N₂O"},{id:"improve-feed-quality",name:"Improve Feed Quality",description:"Upgrade feed quality by 2 points",icon:e.jsx(w,{className:"w-5 h-5"}),apply:()=>n("feedQuality",Math.min(10,s.feedQuality+2)),revert:()=>n("feedQuality",Math.max(1,s.feedQuality-2)),isApplied:()=>s.feedQuality>7,impact:"+15% NUE"},{id:"reduce-concentrate",name:"Optimize Concentrate Feed",description:"Reduce concentrate by 1 kg/day",icon:e.jsx(y,{className:"w-5 h-5"}),apply:()=>n("concentrateFeed",Math.max(0,s.concentrateFeed-1)),revert:()=>n("concentrateFeed",s.concentrateFeed+1),isApplied:()=>s.concentrateFeed<8,impact:"+10% feed efficiency"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Quick Scenario Builder"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Toggle practices below to see their impact on your emissions and costs. Each change updates calculations in real-time."})]}),e.jsx("div",{className:"space-y-3",children:l.map(a=>e.jsx("div",{className:`
              border rounded-lg p-4 transition-all cursor-pointer
              ${a.isApplied()?"bg-green-50 border-green-300":"bg-white border-gray-200 hover:border-gray-300"}
            `,onClick:()=>a.isApplied()?a.revert():a.apply(),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`
                  p-2 rounded-lg
                  ${a.isApplied()?"bg-green-200 text-green-700":"bg-gray-100 text-gray-600"}
                `,children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description}),e.jsx("div",{className:"flex items-center mt-2 space-x-4",children:e.jsx("span",{className:"text-xs font-medium text-green-600",children:a.impact})})]})]}),e.jsx("button",{className:`
                  px-3 py-1 rounded-md text-sm font-medium transition-colors
                  ${a.isApplied()?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"}
                `,onClick:m=>{m.stopPropagation(),a.isApplied()?a.revert():a.apply()},children:a.isApplied()?"Active":"Apply"})]})},a.id))}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Active Practices Summary"}),e.jsxs("div",{className:"space-y-1",children:[l.filter(a=>a.isApplied()).map(a=>e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(R,{className:"w-4 h-4 text-green-600 mr-2"}),a.name]},a.id)),l.filter(a=>a.isApplied()).length===0&&e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No practices applied yet. Click on any practice above to see its impact."})]})]})]})},O=()=>{const i=M();j();const s=x.useMemo(()=>({grossEmissions:1234,sequestration:50,netEmissions:1184,emissionsIntensity:1.45,costPerLitre:.31,annualProfit:125e3,lme:7500}),[]),n=[{label:"Gross Emissions",baseline:s.grossEmissions,scenario:i.totalFarmEmissions,unit:"t CO₂e/year",format:t=>t.toFixed(0),inverse:!0},{label:"Sequestration",baseline:s.sequestration,scenario:i.sequestration.totalSequestration,unit:"t CO₂e/year",format:t=>t.toFixed(0),inverse:!1},{label:"Net Emissions",baseline:s.netEmissions,scenario:i.netFarmEmissions,unit:"t CO₂e/year",format:t=>t.toFixed(0),inverse:!0},{label:"Emissions Intensity",baseline:s.emissionsIntensity,scenario:i.emissionsIntensity,unit:"kg CO₂e/L",format:t=>t.toFixed(2),inverse:!0},{label:"Cost per Litre",baseline:s.costPerLitre,scenario:i.costPerLitre,unit:"£/L",format:t=>t.toFixed(3),inverse:!0},{label:"Annual Profit",baseline:s.annualProfit,scenario:i.totalFarmProfit,unit:"£",format:t=>`£${(t/1e3).toFixed(0)}k`,inverse:!1},{label:"Lifetime Methane Efficiency",baseline:s.lme,scenario:i.lmeResult.lme,unit:"L/t CO₂e",format:t=>t.toFixed(0),inverse:!1}],l=(t,o)=>Math.abs(t)<.01?e.jsx(y,{className:"w-4 h-4 text-gray-400"}):(o?t<0:t>0)?e.jsx(u,{className:"w-4 h-4 text-green-600"}):e.jsx(F,{className:"w-4 h-4 text-red-600"}),a=(t,o)=>Math.abs(t)<.01?"text-gray-600":(o?t<0:t>0)?"text-green-600":"text-red-600",m=(t,o)=>{const c=(o-t)/t*100;return`${c>0?"+":""}${c.toFixed(1)}%`};return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Scenario Comparison"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 pr-4 text-sm font-medium text-gray-700",children:"Metric"}),e.jsx("th",{className:"text-right px-4 py-2 text-sm font-medium text-gray-700",children:"Baseline"}),e.jsx("th",{className:"text-right px-4 py-2 text-sm font-medium text-gray-700",children:"Scenario"}),e.jsx("th",{className:"text-center px-4 py-2 text-sm font-medium text-gray-700",children:"Change"})]})}),e.jsx("tbody",{children:n.map(t=>{const o=t.scenario-t.baseline,c=m(t.baseline,t.scenario);return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 pr-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.label}),e.jsx("div",{className:"text-xs text-gray-500",children:t.unit})]})}),e.jsx("td",{className:"text-right px-4 py-3 text-gray-700",children:t.format(t.baseline)}),e.jsx("td",{className:"text-right px-4 py-3 font-medium text-gray-900",children:t.format(t.scenario)}),e.jsx("td",{className:"text-center px-4 py-3",children:e.jsxs("div",{className:`flex items-center justify-center space-x-1 ${a(o,t.inverse||!1)}`,children:[l(o,t.inverse||!1),e.jsx("span",{className:"font-medium text-sm",children:c})]})})]},t.label)})})]})}),e.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(u,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-900",children:"Overall Impact"}),e.jsxs("p",{className:"text-sm text-green-700 mt-1",children:["Net emissions reduced by ",Math.round((s.netEmissions-i.netFarmEmissions)/s.netEmissions*100),"%",i.totalFarmProfit>s.annualProfit&&` while increasing profit by £${((i.totalFarmProfit-s.annualProfit)/1e3).toFixed(0)}k`]})]})]})})]})},L=({baselineParams:i,scenarioParams:s,scenarioName:n})=>{const l=x.useMemo(()=>{const r=b(i);return N(r.totalAnnualEmissions,i.herdSize)*1e3},[i]),a=x.useMemo(()=>{const r=b(s);return N(r.totalAnnualEmissions,s.herdSize)*1e3},[s]),m=l-a,t=m/l*100,o=x.useMemo(()=>E(s),[s]),c=x.useMemo(()=>C(o,720,0),[o]),g=x.useMemo(()=>{const r=[];if(s.methaneInhibitor&&!i.methaneInhibitor&&r.push({name:"Methane Inhibitor",cost:3e4}),s.improvedManure&&!i.improvedManure&&r.push({name:"Improved Manure System",cost:5e4}),s.renewableEnergyKw>i.renewableEnergyKw){const d=s.renewableEnergyKw-i.renewableEnergyKw;r.push({name:`Solar Panels (${d} kW)`,cost:d*1500})}if(s.treePlantingHa>i.treePlantingHa){const d=s.treePlantingHa-i.treePlantingHa;r.push({name:`Tree Planting (${d} ha)`,cost:d*2e3})}return s.grazingMonths>i.grazingMonths&&r.push({name:"Extended Grazing",cost:1e4}),s.nitrogenRate<i.nitrogenRate&&r.push({name:"Nitrogen Optimization",cost:5e3}),r},[i,s]),p=g.reduce((r,d)=>r+d.cost,0),f=m*.025,k=p/f;return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Financing Analysis: ",n]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-3 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-700 mb-1",children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Emissions Reduction"})]}),e.jsxs("p",{className:"text-xl font-bold text-green-900",children:[t.toFixed(1),"%"]}),e.jsxs("p",{className:"text-xs text-green-600",children:[m.toFixed(0)," kg CO₂e/year"]})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-700 mb-1",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Total Investment"})]}),e.jsxs("p",{className:"text-xl font-bold text-blue-900",children:["$",p.toLocaleString()]}),e.jsx("p",{className:"text-xs text-blue-600",children:"One-time cost"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-700 mb-1",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Simple Payback"})]}),e.jsxs("p",{className:"text-xl font-bold text-purple-900",children:[k.toFixed(1)," years"]}),e.jsx("p",{className:"text-xs text-purple-600",children:"From carbon credits"})]}),e.jsxs("div",{className:"bg-yellow-50 p-3 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-700 mb-1",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Monthly Payment"})]}),e.jsxs("p",{className:"text-xl font-bold text-yellow-900",children:["$",c.totalMonthlyCost.toFixed(0)]}),e.jsx("p",{className:"text-xs text-yellow-600",children:"With financing"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Investment Breakdown"}),e.jsxs("div",{className:"space-y-2",children:[g.map((r,d)=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsx("span",{className:"text-sm text-gray-600",children:r.name}),e.jsxs("span",{className:"text-sm font-medium",children:["$",r.cost.toLocaleString()]})]},d)),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Total"}),e.jsxs("span",{className:"text-sm font-bold",children:["$",p.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Recommended Financing"}),c.financingOptions.length>0?e.jsx("div",{className:"space-y-2",children:c.financingOptions.slice(0,3).map((r,d)=>e.jsxs("div",{className:"flex justify-between items-start text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.option.name}),e.jsxs("p",{className:"text-xs text-gray-600",children:["$",r.amount.toLocaleString()," at ",((r.option.interestRate-r.option.greenDiscount)*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:["$",r.monthlyCost.toFixed(0),"/mo"]}),e.jsxs("p",{className:"text-xs text-gray-600",children:[r.option.term," years"]})]})]},d))}):e.jsx("p",{className:"text-sm text-gray-600",children:"No financing needed - practices already implemented"}),e.jsxs("div",{className:"mt-3 pt-3 border-t",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("span",{className:"text-sm font-medium",children:"Financial Summary"})}),e.jsxs("div",{className:"mt-2 space-y-1 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"NPV (10 years):"}),e.jsxs("span",{className:c.netPresentValue>0?"text-green-600 font-medium":"text-red-600",children:["$",c.netPresentValue.toFixed(0)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"IRR:"}),e.jsxs("span",{className:"font-medium",children:[(c.internalRateOfReturn*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Carbon value/year:"}),e.jsxs("span",{className:"font-medium",children:["$",f.toFixed(0)]})]})]})]})]}),p>0&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-800",children:["💡 This scenario qualifies for green financing with monthly payments as low as",e.jsxs("span",{className:"font-semibold",children:[" $",c.totalMonthlyCost.toFixed(0)]})]})})]})},T=({state:i,actions:s})=>{const n=j(m=>m.parameters),[l]=x.useState({...n}),a=x.useMemo(()=>n.methaneInhibitor!==l.methaneInhibitor||n.improvedManure!==l.improvedManure||n.renewableEnergyKw!==l.renewableEnergyKw||n.treePlantingHa!==l.treePlantingHa||n.grazingMonths!==l.grazingMonths||n.nitrogenRate!==l.nitrogenRate,[n,l]);return e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Scenario Planning & What-If Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx($,{})}),e.jsx("div",{children:e.jsx(O,{})})]}),a&&e.jsx("div",{className:"mt-6",children:e.jsx(L,{baselineParams:l,scenarioParams:n,scenarioName:"Current Scenario"})})]})};export{T as default};
