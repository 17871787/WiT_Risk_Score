import{c as h,b as m,u as f,j as e,P as x,s as d,r as u,l as p,T as b}from"./index-d6534032.js";import{L as g}from"./leaf-6580ae76.js";const y=h("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),E=h("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),C=()=>{const{parameters:s,updateParameter:n}=m(),{performanceMetrics:t}=f(),i=(r,l,c=!1)=>c?r<=l?"text-green-600":r<=l*1.2?"text-yellow-600":"text-red-600":r>=l?"text-green-600":r>=l*.8?"text-yellow-600":"text-red-600",a=(r,l,c=!1)=>c?r<=l?"bg-green-500":r<=l*1.2?"bg-yellow-500":"bg-red-500":r>=l?"bg-green-500":r>=l*.8?"bg-yellow-500":"bg-red-500";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-800 mb-3",children:"Overall Herd Effectiveness Score"}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("div",{className:`text-4xl font-bold ${i(t.overallHerdEffectiveness,x.OVERALL_HERD_EFFECTIVENESS_TARGET)}`,children:[t.overallHerdEffectiveness.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Target: ≥",x.OVERALL_HERD_EFFECTIVENESS_TARGET,"%"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Heifers Calving <25 months"}),e.jsxs("span",{className:`text-xs font-bold ${i(t.calvingUnder25Pct,90)}`,children:[t.calvingUnder25Pct.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${a(t.calvingUnder25Pct,90)}`,style:{width:`${t.calvingUnder25Pct}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Current: ",s.ageFirstCalving.toFixed(1)," months"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Achieving 380-day CI Target"}),e.jsxs("span",{className:`text-xs font-bold ${i(t.hitCalvingIntervalPct,90)}`,children:[t.hitCalvingIntervalPct.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${a(t.hitCalvingIntervalPct,90)}`,style:{width:`${t.hitCalvingIntervalPct}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Current: ",s.calvingInterval," days"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Herd Retention Rate"}),e.jsxs("span",{className:`text-xs font-bold ${i(t.retentionRate,x.RETENTION_RATE_TARGET)}`,children:[t.retentionRate.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${a(t.retentionRate,x.RETENTION_RATE_TARGET)}`,style:{width:`${t.retentionRate}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Replacement: ",t.replacementRate.toFixed(1),"% | Avg lactations: ",s.avgLactations.toFixed(1)]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-blue-200",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Calculation:"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("div",{children:[t.calvingUnder25Pct.toFixed(0),"% ×",t.hitCalvingIntervalPct.toFixed(0),"% ×",t.retentionRate.toFixed(0),"% =",e.jsxs("strong",{children:[" ",t.overallHerdEffectiveness.toFixed(1),"%"]})]}),e.jsx("div",{className:"text-xs text-gray-500 italic",children:"(% <25mo) × (% hit CI) × (retention rate)"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Improvement Tips:"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.ageFirstCalving>25&&e.jsx("li",{children:"• Reduce age at first calving to under 25 months through better heifer management"}),s.calvingInterval>380&&e.jsx("li",{children:"• Improve heat detection and breeding programs to achieve 380-day calving interval"}),t.retentionRate<75&&e.jsx("li",{children:"• Increase cow longevity through better health management and culling decisions"}),t.overallHerdEffectiveness>=70&&e.jsx("li",{children:"• Excellent performance! Maintain current management practices"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>{n("ageFirstCalving",24)},className:"text-xs bg-blue-100 text-blue-700 px-3 py-2 rounded hover:bg-blue-200 transition-colors",children:"Optimize Heifer Age"}),e.jsx("button",{onClick:()=>{n("calvingInterval",380)},className:"text-xs bg-blue-100 text-blue-700 px-3 py-2 rounded hover:bg-blue-200 transition-colors",children:"Optimize Calving Interval"})]})]})},o={MILK_N_CONTENT:.0055,HECTARES_PER_COW:.5,FEED_N_CONTENT:{BASE:.016,MULTIPLIER:.0016},MANURE_N_EFFICIENCY:{"Liquid/slurry":.45,Solid:.35,"Daily spread":.3,"Anaerobic digester":.55,Pasture:.25},NUE_THRESHOLDS:{POOR:60,AVERAGE:80,GOOD:100}},w=s=>d(s,625,.025),N=s=>{const n=s.nitrogenRate*o.HECTARES_PER_COW,t=w(s.crudeProtein),i=s.concentrateFeed*365*t;return n+i},j=s=>s.milkYield*o.MILK_N_CONTENT,v=s=>{const n=j(s),t=N(s),i=d(n,t,0)*100;return Math.min(i,150)},R=s=>s>=o.NUE_THRESHOLDS.GOOD?{category:"Excellent",color:"text-green-700",bgColor:"bg-green-50",description:"Outstanding nitrogen efficiency"}:s>=o.NUE_THRESHOLDS.AVERAGE?{category:"Good",color:"text-blue-700",bgColor:"bg-blue-50",description:"Above average nitrogen efficiency"}:s>=o.NUE_THRESHOLDS.POOR?{category:"Average",color:"text-yellow-700",bgColor:"bg-yellow-50",description:"Room for improvement in N management"}:{category:"Poor",color:"text-red-700",bgColor:"bg-red-50",description:"Significant N losses to environment"},F=(s,n)=>{const t=[];return s.nitrogenRate>200&&t.push("Reduce N fertilizer application rate to <200 kg N/ha"),s.crudeProtein>18&&t.push("Optimize dietary protein to 16-18% CP"),s.manureSystem!=="Anaerobic digester"&&n<80&&t.push("Consider anaerobic digestion for better N recovery"),s.milkYield<8e3&&n<80&&t.push("Improve milk productivity to dilute N losses"),s.feedQuality<8&&t.push("Improve feed quality for better N utilization"),t},T=()=>{const{parameters:s}=m();return u.useMemo(()=>{const n=v(s),t=N(s),i=j(s),a=R(n),r=F(s,n);return{nue:n,nInputs:t,nOutputs:i,interpretation:a,recommendations:r,milkNContent:o.MILK_N_CONTENT,nBalance:t-i}},[s])},I=()=>{const{nue:s,nInputs:n,nOutputs:t,interpretation:i,recommendations:a,nBalance:r}=T();return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Nitrogen Use Efficiency (NUE)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`${i.bgColor} rounded-lg p-4`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Current NUE"}),e.jsxs("p",{className:`text-3xl font-bold ${i.color}`,children:[s.toFixed(1),"%"]}),e.jsx("p",{className:`text-sm ${i.color} mt-1`,children:i.category})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-xs text-gray-500",children:i.description})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4 text-blue-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"N Inputs"})]}),e.jsxs("p",{className:"text-xl font-semibold text-blue-700",children:[n.toFixed(1)," kg N/cow"]})]}),e.jsxs("div",{className:"bg-green-50 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-green-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"N Outputs"})]}),e.jsxs("p",{className:"text-xl font-semibold text-green-700",children:[t.toFixed(1)," kg N/cow"]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded p-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"N Surplus (potential loss)"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:[r.toFixed(1)," kg N/cow/year"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[(r*4.5).toFixed(0)," kg CO₂e equivalent"]})]}),a.length>0&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recommendations to improve NUE:"}),e.jsx("ul",{className:"space-y-1",children:a.map((l,c)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"text-blue-500 mr-2",children:"•"}),l]},c))})]})]})]})},O=s=>{const n=p({annualMilkYield:s.milkYield,averageLactations:s.avgLactations,ageAtFirstCalving:s.ageFirstCalving,calvingInterval:s.calvingInterval,feedQuality:s.feedQuality,systemType:s.systemType,concentrateFeed:s.concentrateFeed,manureSystem:s.manureSystem,grazingMonths:s.grazingMonths,feedCarbonFootprint:s.feedCarbonFootprint,soyaContent:s.soyaContent,deforestationFree:s.deforestationFree,nitrogenRate:s.nitrogenRate,season:s.season}),t=v(s),i=n.lme*d(t,100,1),a=Math.min(d(n.lme,15,0)*50,50),r=Math.min(d(t,150,0)*50,50),l=a+r,c=S(i,l);return{lme:n.lme,nue:t,lmePlus:i,sustainabilityScore:l,interpretation:c}},S=(s,n)=>n>=80&&s>=10?{category:"Excellent",color:"text-green-700",bgColor:"bg-green-50",description:"Industry-leading sustainability performance"}:n>=65&&s>=8?{category:"Good",color:"text-blue-700",bgColor:"bg-blue-50",description:"Above average environmental efficiency"}:n>=50&&s>=6?{category:"Average",color:"text-yellow-700",bgColor:"bg-yellow-50",description:"Room for improvement in both metrics"}:{category:"Poor",color:"text-red-700",bgColor:"bg-red-50",description:"Significant opportunities for improvement"},M=()=>{const{parameters:s}=m(),n=u.useMemo(()=>O(s),[s]),{lme:t,nue:i,lmePlus:a,sustainabilityScore:r,interpretation:l}=n;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LME+NUE Combined Metric"}),e.jsx(g,{className:"w-5 h-5 text-green-600"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`${l.bgColor} rounded-lg p-4`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"LME+NUE Score"}),e.jsx("p",{className:`text-3xl font-bold ${l.color}`,children:a.toFixed(1)}),e.jsx("p",{className:`text-sm ${l.color} mt-1`,children:l.category})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sustainability"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-700",children:[r.toFixed(0),"/100"]})]})]}),e.jsx("p",{className:`text-xs ${l.color} mt-2`,children:l.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-blue-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"LME"})]}),e.jsxs("p",{className:"text-xl font-semibold text-blue-700",children:[t.toFixed(1)," L/kg CO₂e"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Emissions efficiency"})]}),e.jsxs("div",{className:"bg-green-50 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4 text-green-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"NUE"})]}),e.jsxs("p",{className:"text-xl font-semibold text-green-700",children:[i.toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Nitrogen efficiency"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Emissions Performance"}),e.jsxs("span",{children:[Math.min(t/15*100,100).toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(t/15*100,100)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Nitrogen Performance"}),e.jsxs("span",{children:[Math.min(i/150*100,100).toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(i/150*100,100)}%`}})})]})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsx("p",{className:"text-xs text-gray-500",children:"This metric combines emissions efficiency (LME) with nitrogen use efficiency (NUE) to provide a comprehensive sustainability assessment. Higher scores indicate better environmental performance across both carbon and nitrogen cycles."})})]})]})},P=({state:s,actions:n})=>e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Sustainability Effectiveness Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"LME Score"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl font-bold text-blue-600",children:s.lmeResult.lme.toFixed(0)}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Target: ≥350 for sustainable dairy"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Industry Benchmark"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Your LME"}),e.jsx("span",{className:"font-bold",children:s.lmeResult.lme.toFixed(0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Industry Average"}),e.jsx("span",{className:"font-medium",children:"320"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Top 10%"}),e.jsx("span",{className:"font-medium text-green-600",children:"380+"})]})]})]}),e.jsx(I,{}),e.jsx(M,{}),e.jsx("div",{className:"col-span-1 lg:col-span-2",children:e.jsx(C,{})})]})]})});export{P as default};
